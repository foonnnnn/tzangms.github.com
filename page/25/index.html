
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Oceanic / 人生海海</title>
  <meta name="author" content="tzangms">

  
  <meta name="description" content="今天用 Open Flash Chart 2 幫 stickeraction, 在管理者的後台加上了圖表, 用來統計過去 30 天內, 每天有多少張貼紙被網友貼上了他們的部落格。 貼紙發起人可以登入 stickeraction 後, 到“貼紙管理&#8221;看看實際的圖表。這個圖表也許多少可...">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://tzangms.com/page/25/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="http://feeds.feedburner.com/tzangms" rel="alternate" title="Oceanic / 人生海海" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Oceanic / 人生海海</a></h1>
  
    <h2>這就是人生阿</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/tzangms" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:tzangms.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/stickeraction/2259">Stickeraction 後台新增統計圖表</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2008-12-11T20:54:37+08:00" pubdate  data-updated="true" >Dec 11<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://tzangms.com/wp-content/uploads/2008/12/stickeraction_backend_stats.jpg"><img src="http://tzangms.com/wp-content/uploads/2008/12/stickeraction_backend_stats.jpg" alt="stickeraction_backend_stats" title="stickeraction_backend_stats" width="500" height="227" class="aligncenter size-full wp-image-2270" /></a>
今天用 <a href="http://tzangms.com/programming/2256">Open Flash Chart 2</a> 幫 <a href="http://stickeraction.com">stickeraction</a>, 在管理者的後台加上了圖表, 用來統計過去 30 天內, 每天有多少張貼紙被網友貼上了他們的部落格。 貼紙發起人可以登入 <a href="http://stickeraction.com">stickeraction</a> 後, 到“貼紙管理&#8221;看看實際的圖表。</p>

<p>這個圖表也許多少可以幫助串連發起人, 了解最近網友串連的狀況, 另外也打算加上一些其他的統計數據, 還有 UI 的改進, 趁我還有空閒的時候 :p 話說我的貼紙都沒很多人貼勒! 幫貼一下啦 XD</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/programming/2256">Open Flash Chart 2 試玩</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2008-12-11T00:19:49+08:00" pubdate  data-updated="true" >Dec 11<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://tzangms.com/web/2253">昨天用了 Google Chart API</a> 來作 <a href="http://stickeraction.com">stickeraction</a> 的圖表, 然後 <a href="http://twitter.com/tkalu">tka</a> 大大在 twitter 上跟我提了 <a href="http://teethgrinder.co.uk/open-flash-chart-2/">Open Flash Chart</a> 這個東西, 所以就來玩了一下。 其實之前就看過 Open flash chart 這個東西, 只是當時沒時間看, 也看不太懂 XD 昨天玩了 <a href="http://code.google.com/intl/zh-TW/apis/chart/">Google Chart API</a> 之後, 大概了解了 Chart 使用的方式之後, 後來在用 Open Flash Chart 時就順手多了。</p>

<p>Open Flash Chart 弄出來的圖表真的是滿不賴的 :p 就跟 clicky 還有 Google Analytics 的圖表一樣, 像是這樣:
<a href="http://tzangms.com/wp-content/uploads/2008/12/ofc2.png"><img src="http://tzangms.com/wp-content/uploads/2008/12/ofc2.png" alt="" title="ofc2" width="500" height="250" class="aligncenter size-full wp-image-2257" /></a></p>

<p>有興趣可以看看<a href="http://stickeraction.com/stats">這個圖表在 stickeraction 實際的樣子</a>。</p>

<p>Open Flash Chart 在使用上還滿簡單的, 大致上分為前端的 flash 跟後端的資料。 以下這裡是前端的部份:</p>

<pre>
<code>&lt;html&gt;
&lt;head&gt;
&lt;script type="text/javascript" src="/js/swfobject.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript"&gt;

swfobject.embedSWF(
    "/assets/open-flash-chart.swf", "stats",
    "600", "300", "9.0.0", "expressInstall.swf",
    {"data-file":"/stats/data"} );

&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div id='stats'&gt;
    &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code>
</pre>


<p>前端應該不會有太大問題, 就只是把相關檔案放好, 指定一下 data-file 的位置就可以了。
( 說明一下, 資料可以直接寫成 javascript 的變數, 不一定要存放在另外的 data-file )</p>

<p>這裡是後端產生給 Open Flash Chart 2 用的資料, 用的是 JSON 的格式, 如下:
/stats/data</p>

<pre>
<code>{ "title": { "text": "Wed Dec 10 2008" }, "elements": [ { "type": "bar_3d", 
"values": [ 2, 3, 9, 5, 9, 7, 9, 7, 9, 9 ], "colour": "#D54C78" } ], 
"x_axis": { "3d": 5, "colour": "#909090", "labels": [ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 ] } }</code>
</pre>


<p>後端的資料看起來很複雜! XD 不過其實 Open Flash Chart 有提供 PHP、Ruby、Python &#8230; 等 library 可供產生出這個 JSON 格式的資料, 以下為 PHP5 的範例程式:</p>

<pre>
<code>srand((double)microtime()*1000000);
$data = array();

// add random height bars:
for( $i=0; $i<10; $i++ )
  $data[] = rand(2,9);

require_once('OFC/OFC_Chart.php');

$title = new OFC_Elements_Title( date("D M d Y") );

$bar = new OFC_Charts_Bar_3d();
$bar->set_values( $data );
$bar->colour = '#D54C78';

$x_axis = new OFC_Elements_Axis_X();
$x_axis->set_3d( 5 );
$x_axis->colour = '#909090';
$x_axis->set_labels( array(1,2,3,4,5,6,7,8,9,10) );

$chart = new OFC_Chart();
$chart->set_title( $title );
$chart->add_element( $bar );
$chart->set_x_axis( $x_axis );

echo $chart->toPrettyString();</code>
</pre>


<p>這樣看起來清楚多了吧(?) XD anyway 這段程式的結果, 可以看看這個 [ <a href="http://tzangms.com/code/ofc/demo.php?m=3d-bar-chart">3D bar chart</a> ], 其實我把 PHP5 library 裡所提供的 examples, 都放到這裡了 <a href="http://tzangms.com/code/ofc/">http://tzangms.com/code/ofc/</a>, 方便看看各個不同樣式的 Flash Chart, 以及跟範例程式對照, 畢竟目前沒有提供 library 的相關說明, 得自己去看 code。</p>

<p>另外, 也做了 stickeraction 的圖表, 可以到這裡看看 <a href="http://stickeraction.com/stats">http://stickeraction.com/stats</a></p>

<p>之後應該會應用在 stickeraction 每個串連貼紙的統計上吧 :p</p>

<p>註: PHP5 library 得用 set_include_path 的方式來載入。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/web/2253">[好書廣告] Google APIs 程式工具錦集</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2008-12-09T22:30:44+08:00" pubdate  data-updated="true" >Dec 9<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://tzangms.com/wp-content/uploads/2008/12/490b2c0657378.jpg"><img src="http://tzangms.com/wp-content/uploads/2008/12/490b2c0657378-276x300.jpg" alt="" title="490b2c0657378" width="276" height="300" class="alignleft size-medium wp-image-2254" /></a>這本<a href="http://tlsj.tenlong.com.tw/WebModule/BookSearch/bookSearchViewAction.do?isbn=9789862043363&sid=47460">Google APIs 程式工具錦集</a>是由 <a href="http://cire.pixnet.net/blog">ddsakura 大大</a>所撰寫, 一開始在本書的第一章介紹了使用 Google API 所需要的基礎知識, 還有對目前 Google 現有的 API 及服務做了簡短的介紹。</p>

<p>本書中最主要的章節如下:</p>

<ul>
    <li>Google AJAX Search API</li>
    <li>Google Maps API</li>
    <li>Google Chart API</li>
    <li>Google Calendar API</li>
    <li>Google Toolbar API</li>
</ul>


<p>而其中我最感興趣的則是 <a href="http://code.google.com/apis/chart/">Google Chart API</a> 了! :D 不過之前一直沒有想到什麼 idea 可以用來做個實戰演練, 可以用來推銷一下 ddsakura 大大的這本書。</p>

<p>今天終於想到一個 idea, 便拿起書來, 大略翻一下 Google Chart API 的章節, 就開始 Trial and error, 玩了起來。 很快的, 想要的圖表馬上就跑出來了! :D 完全只依賴手上這本書阿!</p>

<p>在研究 Google Chart API 時, 發現書中的範例真的很多, 似乎包含了所有圖表樣式的範例, 而且只要翻一翻、查一下參數, 就可以很快的找到想要的資料, 想要做的圖表就完成了 :D</p>

<p>今天想到要拿來作範例的就是 <a href="http://stickeraction.com">stickeraction</a> 的貼紙統計, 用來統計過去三十天, 每天共有多少張貼紙被貼上網友自己的部落格。</p>

<p>以下為今天利用 Google Chart API 所寫的範例: (將每個參數分行)</p>

<pre>
<code>&lt;img src='http://chart.apis.google.com/chart?
chs=600x300&amp;
cht=lc&amp;
chxt=x,y&amp;
chd=t:19,100,59,54,79,56,62,42,31,29,30,33,27,42,43,33,30,24,47,44,30,33,4,51,24,24,38,30,38,33,19&amp;
chxl=0:|2008/11/09|2008/11/16|2008/11/23|2008/11/30|2008/12/07&amp;
chxr=0,1,30|1,1,442&amp;
chg=10,10' /&gt;</code>
</pre>


<p>用上程式碼即可產生下面這張圖:
<a href="http://tzangms.com/wp-content/uploads/2008/12/chart.png"><img src="http://tzangms.com/wp-content/uploads/2008/12/chart.png" alt="" title="chart" width="500" height="250" class="alignnone size-full wp-image-2255" /></a></p>

<p>實際畫面, 可以到<a href="http://stickeraction.com/stats">這裡看看</a>。</p>

<p>靠這本書從無到有, 似乎只花大概 10 分鐘左右, 就把上面這張圖給弄出來了說。 在這本書中對 Google Chart API 的參數都有詳細的範例解說, 很容易就讓我拼湊出來這個圖表, 而根本不用連上 Google code 去翻找文件, 不過 Google 的 API 都還滿常更新的, 要看最新資訊還是得上 Google Code 看文件。 而這本書來當入門跟參考真的是再好不過了!</p>

<p>另外, 可能很多人對 Google Maps 的 API 比較有興趣, 那這本書應該也不錯用, 因為 Google Maps 的部份大概就佔了這本書約三分之一的篇幅, 等我有時間再來玩玩看 Google Maps XD</p>

<p>想玩 Google API 的朋友們, 參考看看吧! <a href="http://tlsj.tenlong.com.tw/WebModule/BookSearch/bookSearchViewAction.do?isbn=9789862043363&sid=47460">Google APIs 程式工具錦集 - 天瓏資訊圖書</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/web/2252">BarCamp NANO Taipei!</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2008-12-07T11:19:08+08:00" pubdate  data-updated="true" >Dec 7<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href='http://stickeraction.com/barcamptw/go'><img src='http://stickeraction.com/barcamptw/sticker' alt='Barcamp NANO 台北！' class='left'></a>Barcamp？「霸營」？「呷霸太贏」？</p>

<p>這是個「非典型」的研討會：一般研討會裡，籌辦人扮演導演的角色，他想拍什麼片就拍、然後邀請你來看；在 Barcamp 裡沒有導演—或者說，老爸老媽哥哥姊姊，只要有心人人都是導演。</p>

<p>你有什麼想發表的東西？這裡給你舞台；早就想凹你朋友傳授一下技巧？要凹就凹到 Barcamp 上來講！在 Barcamp 裡所有的講題，都是現場提出、當場協調排定。只要你能取得「霸佔」時間空間的權利，要用來討論、分享、共同創作什麼的，都隨你主持。同時分多軌進行的特色，讓你想聽什麼就聽什麼，不必受制於別人。簡言之，這是充滿創意火花與驚喜的研討會，會碰見什麼玩意就只有來了才知道！</p>

<p><a href="http://www.barcamp.org/BarCampTaipei">BarCamp Taipei 官方wiki</a></p>

<p>Oh my god! 看了以上對 BarCamp 的簡略說明之後, 難道你不覺得很有趣嗎!!? 先<a href="http://www.barcamp.org/BarCampTaipei">看看官方 wiki</a>, 然後 12/10 晚上, 一起來去玩玩吧!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/programming/2251">用 Simplepie Live 讀取 RSS</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2008-12-07T00:53:21+08:00" pubdate  data-updated="true" >Dec 7<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>昨天在弄我網站的首頁, 想說做個單純的 HTML, 不過想要在上面放個部落格最新文章的列表, 所以就想說用 <a href="http://live.simplepie.org/">Simplepie Live</a> 來玩玩看, 就寫了下面那一段。</p>

<p>首先要使用 Simplepie Live, 只要先放進他所提供的 javascript。</p>

<pre>
<code>&lt;script type="text/javascript" src="http://live.simplepie.org/app/0.5/base.js"&gt;&lt;/script&gt;</code>
</pre>


<p>然後就有 Simplepie Live 的物件可以用來讀取 RSS 囉, 範例如下方。</p>

<p>先說明一下下面這一段&#8230; 基本上, 就是網頁裡先有一個空的 ul tag, id 為 rss, 然後就用 Simplepie Live 把 RSS 文章的標題跟連結都包進一個 li tag, 然後放進 ul, 這樣。</p>

<pre>
<code>window.onload = function() {
    var url = 'http://feeds.feedburner.com/tzangms';

    var feed = new SimplePie(url, {
        onSuccess: function(feed) {
            var rss = document.getElementById('rss');
            for (var i in feed.items) {
                var title = feed.items[i].title;
                var permalink = feed.items[i].permalink

                var text = document.createTextNode(title);

                var a = document.createElement('a');
                a.setAttribute('href', permalink);
                a.appendChild(text);

                var li = document.createElement('li');
                li.appendChild(a);

                rss.appendChild(li);
            }
        }
    });
}</code>
</pre>


<p>不過, 其實用 <a href="http://code.google.com/apis/ajaxfeeds/">Google AJAX Feed API</a> 好像還比較快 XD</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/web design/2250">CSS 透明</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2008-12-06T00:59:06+08:00" pubdate  data-updated="true" >Dec 6<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><pre>
<code>filter:alpha(opacity=70);
-moz-opacity:0.7;
-khtml-opacity: 0.7;
opacity: 0.7;</code>
</pre>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2245">MovableType 4 轉 Wordpress 2.6</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2008-12-03T20:17:07+08:00" pubdate  data-updated="true" >Dec 3<span>rd</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>記錄一下由 <a href="http://www.movabletype.org/">MovableType</a> 轉換至 <a href="http://wordpress.org/">Wordpress</a> 的東西。 其實要從 MT 轉換到 Wordpress 還滿簡單的, 只要從 MT 匯出, 在從 Wordpress 匯入即可, 不過要顧及 SEO 的部份, 不讓原有的網址失效, 就得花點工夫來處理。</p>

<p>在 MT 的匯出檔案中, 並沒有帶著每篇文章的 post id。 而匯入到 Wordpress 之後的 post id, 則是累加上去的, 所以在轉換、匯入到 Wordpress 之後, 無法根據文章的 post id 來做 url rewire, 把舊的網址給轉到新的網址。 這麼一來, 舊的網址就會失效, 原本的 page rank 也可以能隨之下降。</p>

<p>所以這裡要來記錄, 如何在轉換之後, 能夠讓原本的網址連至新的網頁。 所以大多都是在針對 post id 的處理, 我們可以根據 post id, 來對應新舊文章。本篇文章以 MT 4.1 轉換至 Wordpress 2.6.5 為範例。</p>

<p>在開始之前, 請先試著把 MT 匯出的檔案匯入到 Wordpress, 看看是否能夠順利匯入, 因為在匯入的時候, 發現到, 如果有重覆的文章標題 (title), 則無法正常進行匯入。 碰到重覆的文章標題時, php 會 time out。 如果有重覆標題時, 請把重覆的標題改掉。 當匯入正常時, 再進行以下步驟。</p>

<ol>
<li>首先, 因為 MT 在匯出檔案時, 是不會有 post id 的, 所以必須修改匯出的程式, 讓他可以匯出 post id。可以修改下面這個檔案:</li>
</ol>


<blockquote>cgi-bin/lib/MT/ImportExport.pm</blockquote>


<p>找到約 480 行, 應該可以看到如下的程式碼:</p>

<pre>
<code>## Create template for exporting a single entry
require MT::Template;
require MT::Template::Context;
my $tmpl = MT::Template->new;
$tmpl->name('Export Template');
$tmpl->text(<<'TEXT');
AUTHOR: <$MTEntryAuthor strip_linefeeds="1"$>
TITLE: <$MTEntryTitle strip_linefeeds="1"$>
BASENAME: <$MTEntryBasename$>
STATUS: <$MTEntryStatus strip_linefeeds="1"$>
ALLOW COMMENTS: <$MTEntryFlag flag="allow_comments"$>
CONVERT BREAKS: <$MTEntryFlag flag="convert_breaks"$>
ALLOW PINGS: <$MTEntryFlag flag="allow_pings"$><MTIfNonEmpty tag="MTEntryCategory">
PRIMARY CATEGORY: <$MTEntryCategory$></MTIfNonEmpty><MTEntryCategories>
CATEGORY: <$MTCategoryLabel$></MTEntryCategories>
DATE: <$MTEntryDate format="%m/%d/%Y %I:%M:%S %p"$><MTEntryIfTagged>
<span style='color:red'>POSTID: <$MTEntryID$></span>
TAGS: <MTEntryTags include_private="1" glue=","><$MTTagName quote="1"$></MTEntryTags></MTEntryIfTagged>
-----
BODY:
<$MTEntryBody convert_breaks="0"$>
-----</code>
</pre>


<p>在這裡, 只要加上紅色那一行, 即可讓 MT 在匯出時帶有 post id。</p>

<ol>
<li>在可以匯出有 post id 的檔案之後, 接下來就是要修改 Wordpress 匯入的部份, 讓 Wordpress 可以讀取檔案中的 post id。 首先修改下面這個檔案:</li>
</ol>


<blockquote>wp-admin/import/mt.php</blockquote>


<p>找到約 330 行左右, 可以看到如下的程式碼:</p>

<pre>
<code>            } else if ( 0 === strpos($line, "TITLE:") ) {
                $title = trim( substr($line, strlen("TITLE:")) );
                if ( '' == $context )
                    $post->post_title = $title;
                else if ( 'ping' == $context )
                    $ping->title = $title;
            <span style='color:red'>} else if ( 0 === strpos($line, "POSTID:") ) {
                $post_id = trim( substr($line, strlen("POSTID:")) );
                $post->post_id = $post_id;</span>
            } else if ( 0 === strpos($line, "STATUS:") ) {</code>
</pre>


<p>只需要加上紅色那三行, 即可讀取到 post id。</p>

<ol>
<li>接下來則是修改寫入資料庫的部份, 修改下面這個檔案:</li>
</ol>


<blockquote>wp-include/post.php </blockquote>


<p>約在 1296 行左右, 可以看到程式碼如下:</p>

<pre>
<code>    if ( 'draft' != $post_status ) {
    ...略...
    }

    <span style='color:red'>$post_ID = (int) $post_id;
    $ID = (int) $post_id;</span>

    // expected_slashed (everything!)
    ...</code>
</pre>


<p>只需要加上紅色那兩行即可。 將我們所讀取到的 post id, 覆寫到要寫入資料庫的變數, 這麼一來, 之後匯入到 Wordpress 的 post id , 就會跟 MT 的 post id 相同, 我們就可以根據這個 post id 來對應新舊文章了!</p>

<ol>
<li><p>接著就開始匯入啦! 當然得先把資料庫清空囉。</p></li>
<li><p>最後, 在匯入 Wordpress 完畢後, 可以在 .htaccess 加上 url rewrite 如下:
PS. Wordpress 的 permalink 是選用 Numeric 的形式。</p></li>
</ol>


<pre>
<code>&lt;IfModule mod_rewrite.c&gt;
RewriteEngine On
RewriteBase /
RewriteRule ^archives/([0-9]{6})\.php$ archives/$1 [R=301,L]
RewriteRule ^archives/(200[0-9])_([0-9]{1,2})\.php$ archives/date/$1/$2 [R=301,L]
RewriteRule ^cgi-bin/mt-search\.cgi?tag=([^&]+).*$ archives/tag/$1 [R=301,L]
RewriteRule ^atom\.xml$ feed/atom [R=301,L]
RewriteRule ^rss\.xml$ feed [R=301,L]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
&lt;/IfModule&gt;</code>
</pre>


<p>差不多就是這樣吧!</p>

<p>喔! 對了, 匯入成功之後, 記得把 wp-include/post.php 改回來嘿。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/life/2244">離職了</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2008-11-28T20:56:13+08:00" pubdate  data-updated="true" >Nov 28<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>今天我離職了, 告別這大約兩年半的第一份工作。要來好好休息一陣子了。</p>

<p>不過我馬上就要趕回宜蘭, 明天是阿公做百日, 今天一定得趕回家的 Orz</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/music/2238">Dixie Chicks - Not Ready to Make Nice</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2008-11-27T20:01:02+08:00" pubdate  data-updated="true" >Nov 27<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><object width="425" height="344"><param name="movie" value="http://www.youtube.com/v/IHH8bfPhusM&hl=zh_TW&fs=1"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><embed src="http://www.youtube.com/v/IHH8bfPhusM&hl=zh_TW&fs=1" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="425" height="344"></embed></object>


<p>今天早上從<a href="http://www.wretch.cc/blog/imgoodness/12898270">志豪那邊</a>看到這個影片, 就點來看看, 原本認為我會聽一小段就馬上跳開了, 沒想到讓我聽到眼淚都飆了出來, Vocal 未免也太猛了!! pitch 準到一個不行, 這可是 Live 阿!!</p>

<p>我當時應該是聽到 1:47 - 2:15 這一段, 眼淚就飆出來了。</p>

<p>題外話, 我覺得鼓手好像有跑去演 MIB 2 ? XD</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/programming/2212">PHP 使用 Memcache</a></h1>
    
    
      <p class="meta">
        





  



<time datetime="2008-11-27T00:06:01+08:00" pubdate  data-updated="true" >Nov 27<span>th</span>, 2008</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>這次我第一次開始用 <a href="http://www.danga.com/memcached/">memcached</a>, 除了在 Google App Engine 上的 memcache 不算的話 XD</p>

<p>首先先裝 <a href="http://www.danga.com/memcached/">memcached</a>, 我使用的是 <a href="http://gentoo.org">gentoo linux</a></p>

<p><code>emerge memcached </code></p>

<p>接著裝上 pecl-memcache</p>

<p><code>emerge dev-php5/pecl-memcache</code></p>

<p>不過目前 amd64 平台的 pecl-memcache 套件還是 masked, 所以只好加上 ACCEPT_KEYWORDS 來安裝。</p>

<p><code>ACCEPT_KEYWORDS='~amd64' emerge dev-php5/pecl-memcache</code></p>

<p>然後把 www server 重開就可以開始用 memcache 了 :D 當然 memcached 也要記得開起來阿 XD</p>

<p>來個簡單的 php 範例:</p>

<pre>
<code>$memcache = new Memcache;
$memcache->connect('127.0.0.1', 11211);
$memcache->set('key', 'value', false, 3600);
$cache_data = $memcache->get('key');</code>
</pre>


<p>大概就是這樣啦! 簡單方便好用阿! :D</p>

<p>不過目前我的一些東西都會用到同一台 memcache server, 所以至少每個網站都得要各自的 key prefix, 才不會衝到, 所以寫了一個給 CodeIgniter 用的 mcache library, 基本上就是個 wrapper, 除了處理 key prefix, 連線, 還有把設定給寫到 config 檔, 可以直接修改 config 檔來設定 memcache, 跟 prefix。</p>

<p>key prefix 處理大概像是這樣, 而 prefix 就是在 config 做設定了:</p>

<pre>
<code>    public function get($key)
    {
        if (!$this->status) return;

        return $this->memcache->get($this->prefix . '_' . $key);
    }

    public function set($key, $value, $compressed = null, $expire = null)
    {
        if (!$this->status) return;

        if (!isset($compressed))
            $compressed = $this->compressed;

        if (!isset($expire))
            $expire = $this->expire;

        $this->memcache->set($this->prefix . '_' . $key, $value, $compressed, $expire);
    }</code>
</pre>


<p>而設定檔像是這樣:</p>

<pre>
<code>$config['memcache_host'] = '127.0.0.1';
$config['memcache_port'] = 11211;
$config['memcache_prefix'] = 'stickeraction';
$config['memcache_compressed'] = MEMCACHE_COMPRESSED;
$config['memcache_expire'] = 60*5;
$config['memcache_pconnect'] = false;</code>
</pre>


<p>目前用來處理 <a href="http://stickeraction.com">stickeraction</a> 貼紙的部份, 大概從 0.01s 降到 0.003s 吧? 其實沒認真測 XD</p>

<p>另外, 可以用 memcache 的 getStats 函式寫一個來看 memcache 的使用情形</p>

<pre>
<code>$memcache = new Memcache;
$memcache->connect('127.0.0.1', 11211);
$stats = $memcache->getStats();
foreach ($stats as $key => $val) {
    echo "$key : $val &lt;br /&gt;";
}</code>
</pre>


<p>在 PHP Manual 的<a href="http://tw2.php.net/manual/en/function.memcache-getstats.php#69727">這裡</a>可以看到相對應的欄位說明, 如下:</p>

<blockquote><pre>pid                       Process id of this server process
uptime                    Number of seconds this server has been running
time                      Current UNIX time according to the server
version                   Version string of this server
rusage_user               Accumulated user time for this process
rusage_system             Accumulated system time for this process
curr_items                Current number of items stored by the server
total_items               Total number of items stored by this server ever since it started
bytes                     Current number of bytes used by this server to store items
curr_connections          Number of open connections
total_connections         Total number of connections opened since the server started running
connection_structures     Number of connection structures allocated by the server
cmd_get                   Cumulative number of retrieval requests
cmd_set                   Cumulative number of storage requests
get_hits                  Number of keys that have been requested and found present
get_misses                Number of items that have been requested and not found
bytes_read                Total number of bytes read by this server from network
bytes_written             Total number of bytes sent by this server to network
limit_maxbytes            Number of bytes this server is allowed to use for storage.</pre></blockquote>


<p>memcache 真的是簡單又好用阿! :D</p>
</div>
  
  


    </article>
  
  <nav class="pagination">
    <div>
      
        <a class="prev" href="/page/26/">&larr; Older</a>
      
      <a href="/blog/archives">Blog Archives</a>
      
      <a class="next" href="/page/24/">Newer &rarr;</a>
      
    </div>
  </nav>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/new-tumblr">tumblr 開張 (tzang.ms)</a>
      </li>
    
      <li class="post">
        <a href="/stuff/blue-snowball">買了 Blue snowball</a>
      </li>
    
      <li class="post">
        <a href="/programming/django-1.3-staticfiles">關於 Django 1.3 的 staticfiles</a>
      </li>
    
      <li class="post">
        <a href="/webdesign/css-pivot">CSS Pivot</a>
      </li>
    
      <li class="post">
        <a href="/life/new-streetvoice-is-done">終於把 StreetVoice 改完了</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Github Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/tzangms">@tzangms</a> on Github
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'tzangms',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("tzangms", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/tzangms" class="twitter-follow-button" data-width="208px" data-show-count="true">Follow @tzangms</a>
  
</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2011 - tzangms -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
    (function () {
      var disqus_shortname = 'tzangms';
      
        
        var disqus_script = 'count.js'
      

      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>



  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-418467-7']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>





</body>
</html>
